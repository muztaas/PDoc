import os
import sys

if os.path.exists(os.path.join(sys.prefix, "pythoncom.pyd")):
    from win32.win32api import *
    from win32.win32gui import *
else:
    def __import_pywin32_system_module__(modname, globs):
        import importlib.util
        if os.path.exists(os.path.join(sys.prefix, f"{modname}.pyd")):
            spec = importlib.util.spec_from_file_location(modname, os.path.join(sys.prefix, f"{modname}.pyd"))
            if spec:
                module = importlib.util.module_from_spec(spec)
                spec.loader.exec_module(module)
                globs.update(module.__dict__)
                return
        raise ImportError(f"No system module '{modname}' ({modname}.pyd)")

    __import_pywin32_system_module__("pythoncom", globals())
