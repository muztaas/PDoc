import os
import sys
import importlib.util

def __import_pywin32_system_module__(modname, globs):
    for path in sys.path:
        lookup = os.path.join(path, "win32", modname + ".pyd")
        if os.path.isfile(lookup):
            mod = importlib.util.spec_from_file_location(modname, lookup)
            if mod is not None:
                module = importlib.util.module_from_spec(mod)
                mod.loader.exec_module(module)
                globs.update(module.__dict__)
                return
    raise ImportError(f"No system module '{modname}' (${modname}.pyd)")

__import_pywin32_system_module__("pywintypes", globals())
